const Application=PIXI.Application,app=new Application,gameOver=document.querySelector(".over");let playerSheet={},jumpPressed=!1,jumpCount=19,jumpUp=!0,jumpDown=!1,keys=[],enemySheet={},enemys=[],cloudsSprite,spriteClouds=[],speedGround=6,currentScore,score=0,maxScore=0,currentMaxScore,plusScore=.05;function doneLoading(){document.addEventListener("keydown",keyDown),document.addEventListener("keyup",keyUp),createTerra(),createPlayerSheet(),createPlayer(),createEnemySheet(),createCloud(),createScore()}function createSheet(e,t,n,r,a){e=new PIXI.BaseTexture.from(app.loader.resources[e].url);return new PIXI.Texture(e,new PIXI.Rectangle(t,n,r,a))}function createTerra(){var e=createSheet("textures",2,105,2400,25);cloudsSprite=new PIXI.TilingSprite(e,app.screen.width,app.screen.height-480),cloudsSprite.y=app.view.height-75,app.stage.addChild(cloudsSprite)}function createCloud(){var e=Math.random(),e=.4<e?e:.7;let t=new PIXI.Sprite.from(createSheet("textures",166,0,92,29));t.x=app.view.width+100,t.y=150*e,t.scale.set(.9*e),t.speed=3*e,spriteClouds.unshift(t),app.stage.addChild(t)}function createPlayerSheet(){var e=new PIXI.BaseTexture.from(app.loader.resources.textures.url);playerSheet.standEast=[new PIXI.Texture(e,new PIXI.Rectangle(1338,0,88,96))],playerSheet.walkEast=[new PIXI.Texture(e,new PIXI.Rectangle(1514,0,88,96)),new PIXI.Texture(e,new PIXI.Rectangle(1602,0,88,96))],playerSheet.walkDownEast=[new PIXI.Texture(e,new PIXI.Rectangle(1866,36,118,60)),new PIXI.Texture(e,new PIXI.Rectangle(1984,36,118,60))]}function createPlayer(){dino=new PIXI.AnimatedSprite(playerSheet.standEast),dino.anchor.set(0,1),dino.animationSpeed=.2,dino.x=100,dino.y=app.view.height-40,dino.loop=!1,app.stage.addChild(dino),dino.play()}function keyDown(e){if(keys[e.keyCode]=!0,"over"==statusGame){if(keys[32]){for(let e=0;e<enemys.length;e++)app.stage.removeChild(enemys[e]),enemys.splice(e,1),--e;maxScore=score>maxScore?Math.floor(score):maxScore,currentMaxScore.text=maxScore,speedGround=6,score=0,plusScore=.05,jumpPressed=!1,jumpDown=!1,jumpUp=!0,jumpCount=19,dino.y=app.view.height-40,statusGame="play",gameOver.classList.remove("isOver")}}else statusGame="play"}function keyUp(e){keys[e.keyCode]=!1}function createEnemySheet(){var e=new PIXI.BaseTexture.from(app.loader.resources.textures.url);enemySheet.typeCactous1=new PIXI.Texture(e,new PIXI.Rectangle(652,0,50,102)),enemySheet.typeCactous2=new PIXI.Texture(e,new PIXI.Rectangle(702,0,48,102)),enemySheet.typeCactous3=new PIXI.Texture(e,new PIXI.Rectangle(752,0,50,102)),enemySheet.typeCactous4=new PIXI.Texture(e,new PIXI.Rectangle(850,0,102,102)),enemySheet.typePterodactyl=[new PIXI.Texture(e,new PIXI.Rectangle(260,0,92,82)),new PIXI.Texture(e,new PIXI.Rectangle(352,0,92,82))]}function createEnemy(){let t;if(t=5==t&&score<100?Math.ceil(5*Math.random()):Math.ceil(4*Math.random()),t<=4){let e=new PIXI.Sprite.from(enemySheet["typeCactous"+t]);e.x=app.view.width+200,e.y=app.view.height-136,e.anchor.set(0,0),e.type=1,enemys.unshift(e),1<enemys.length&&enemys[1].x>e.x-200&&(enemys[0].x+=300),app.stage.addChild(e)}else{let e=new PIXI.AnimatedSprite(enemySheet.typePterodactyl);e.loop=!0,e.animationSpeed=.087,e.x=app.view.width+200,.5<Math.random()?(e.y=app.view.height-140,e.type=1):(e.y=app.view.height-205,e.type=0),e.anchor.set(0,0),enemys.unshift(e),1<enemys.length&&(enemys[1].x>e.x-200&&(enemys[0].x+=300),e.play()),app.stage.addChild(e)}}function createScore(){var e=new PIXI.TextStyle({fontFamily:"Pixi",fontSize:55,fill:"#276c9e",stroke:"#ffffff",strokeThickness:3});currentScore=new PIXI.Text(score,e),currentScore.style.worldMap=!1,currentScore.x=20,app.stage.addChild(currentScore),currentMaxScore=new PIXI.Text(maxScore,e),currentMaxScore.x=app.view.width-100,currentMaxScore.style.worldMap=!1,app.stage.addChild(currentMaxScore)}function gameLoop(){if("wait"!=statusGame&&"over"!=statusGame){keys[38]||keys[40]||dino.playing||(dino.textures=playerSheet.walkEast,dino.play()),keys[40]&&(dino.playing||(dino.textures=playerSheet.walkDownEast,dino.play())),keys[38]&&(keys[38]=!1,jumpPressed=!0),jumpPressed&&(jumpUp&&(0<jumpCount?(--jumpCount,dino.y-=jumpCount):(jumpUp=!1,jumpDown=!0)),jumpDown&&(jumpCount<=17?(jumpCount+=1,dino.y+=jumpCount):(jumpCount=19,jumpPressed=!1,jumpDown=!1,jumpUp=!0))),rectsIntersect(enemys)&&(gameOver.classList.add("isOver"),statusGame="over"),.986<Math.random()&&enemys.length<2&&createEnemy();for(let e=0;e<enemys.length;e++)enemys[e].x-=speedGround,enemys[e].x<-100&&(app.stage.removeChild(enemys[e]),enemys.splice(e,1));cloudsSprite.tilePosition.x-=speedGround,.9888<Math.random()&&spriteClouds.length<5&&createCloud();for(let e=0;e<spriteClouds.length;e++)spriteClouds[e].x-=spriteClouds[e].speed,spriteClouds[e].x<-100&&(app.stage.removeChild(spriteClouds[e]),spriteClouds.splice(e,1));score+=plusScore,currentScore.text=Math.floor(score),200<score&&0==enemys.length&&(speedGround=8,plusScore=.07)}}function rectsIntersect(){let t;for(let e=0;e<enemys.length;e++)1!=enemys[e].type&&(t=dino.x+dino.width/1.25>=enemys[e].x&&dino.x<=enemys[e].x+enemys[e].width/1.5&&dino.y-dino.height<=enemys[e].y+enemys[e].height),1==enemys[e].type&&(t=dino.x+dino.width/1.25>=enemys[e].x&&dino.x<=enemys[e].x+enemys[e].width/1.5&&dino.y-dino.height-60>=enemys[e].y-enemys[e].height);return t}statusGame="wait",app.renderer.backgroundColor=8925262,app.renderer.resize(900,500),document.querySelector(".playground").appendChild(app.view),app.loader.add("textures","./img/sprite.png"),app.loader.load(doneLoading),app.ticker.add(gameLoop);